<input class="hidden" value="0" type="number" name="attr_skademod"/>
<input class="hidden" value="0" type="number" name="attr_dicemod"/>

<h1 align="center">Splatter</h1>

<br>

<div class='3colrow'>
  <div class='col'>
    <div class="egenskaper">
        <div class="data">
            <h4>Namn</h4>
            <input class="line" name="attr_character_name" type="text" />
        </div>
        
        <div class="data">
            <h4>Ålder</h4>
            <input class="line" name="attr_age" type="text" />
        </div>
        
        <div class="data">
            <h4>Kön</h4>
            <input class="line" name="attr_sex" type="text" />
        </div>
            
        <div class="data">        
            <h4>Karriär</h4>
            <input class="line" name="attr_career" type="text" />
        </div>
        
        <div class="data">    
            <h4>Huvudhand</h4>
            <input class="line" name="attr_mainhand" type="text" />
        </div>
        
        <div class="data">    
            <h4>Längd</h4>
            <input class="line" name="attr_height" type="text" />
        </div>
        
        <div class="data">    
            <h4>Vikt</h4>
            <input class="line" name="attr_weight" type="text" />
        </div>
        
        <div class="data">    
            <h4>Ögon</h4>
            <input class="line" name="attr_eyes" type="text" />
        </div>
        
        <div class="data">    
            <h4>Hår</h4>
            <input class="line" name="attr_hair" type="text" />
        </div>
        
        <br>
        
        <h4>Fördelar</h4>
        <textarea name="attr_fordelar" class="anteckningar" rows="1"></textarea>
        
        <br>
        
        <h4>Nackdelar</h4>
        <textarea name="attr_nackdelar" class="anteckningar" rows="1"></textarea>
    </div>
  </div>

  <div class='col'>
    <div>
        <h3>Egenskaper</h3>
        <div class="egenskaper">
            <div>
                <h4>Smidighet 
                    <input type="number" name="attr_smi" value="2" />
                    <button type="roll" value="/e rolls Smidighet [[((@{smi}-@{dicemod})d6)-(?{Svårighetsgrad|5}-@{skademod})]]" name="roll_smi"></button>
                </h4>
            </div>
            <div>
                <h4>Reaktion 
                    <input type="number" name="attr_rea" value="2" />
                    <button type="roll" value="/e rolls Reaktion [[((@{rea}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_rea"></button>
                </h4>
            </div>
            <div>
                <h4>Styrka 
                    <input type="number" name="attr_sty" value="2" />
                    <button type="roll" value="/e rolls Styrka [[((@{sty}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_sty"></button>
                </h4>
            </div>
            <div>
                <h4>Fysik 
                    <input type="number" name="attr_fys" value="2" />
                    <button type="roll" value="/e rolls Fysik [[((@{fys}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_fys"></button>
                </h4>
            </div>
            <div>
                <h4>Psyke 
                    <input type="number" name="attr_psy" value="2" />
                    <button type="roll" value="/e rolls Psyke [[((@{psy}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_psy"></button>
                </h4>
            </div>
            <div>
                <h4>Visdom 
                    <input type="number" name="attr_vis" value="2" />
                    <button type="roll" value="/e rolls Visdom [[((@{vis}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_vis"></button>
                </h4>
            </div>
            <div>
                <h4>Karisma 
                    <input type="number" name="attr_kar" value="2" />
                    <button type="roll" value="/e rolls Karisma [[((@{kar}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_kar"></button>
                </h4>
            </div>
            <div>
                <h4>Intelligens 
                    <input type="number" name="attr_int" value="2" />
                    <button type="roll" value="/e rolls Intelligens [[((@{int}-@{dicemod})d6)-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_int"></button>
                </h4>
            </div>
        </div>
    </div>
    
    <br>
    
    <div>
        <h3>Specialiseringar</h3>
        <div class="item">
            <input class="name" name="attr_spec1" type="text" />
            <input type="number" name="attr_spec1_num" value="0" />
            <select class="eg_select" name="attr_spec1_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec1} [[(((@{spec1_select}-@{dicemod})d6) + @{spec1_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec1"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec2" type="text" />
            <input type="number" name="attr_spec2_num" value="0" />
            <select class="eg_select" name="attr_spec2_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec2} [[(((@{spec2_select}-@{dicemod})d6) + @{spec2_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec2"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec3" type="text" />
            <input type="number" name="attr_spec3_num" value="0" />
            <select class="eg_select" name="attr_spec3_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec3} [[(((@{spec3_select}-@{dicemod})d6) + @{spec3_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec3"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec4" type="text" />
            <input type="number" name="attr_spec4_num" value="0" />
            <select class="eg_select" name="attr_spec4_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec4} [[(((@{spec4_select}-@{dicemod})d6) + @{spec4_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec4"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec5" type="text" />
            <input type="number" name="attr_spec5_num" value="0" />
            <select class="eg_select" name="attr_spec5_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec5} [[(((@{spec5_select}-@{dicemod})d6) + @{spec5_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec5"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec6" type="text" />
            <input type="number" name="attr_spec6_num" value="0" />
            <select class="eg_select" name="attr_spec6_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec6} [[(((@{spec6_select}-@{dicemod})d6) + @{spec6_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec6"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec7" type="text" />
            <input type="number" name="attr_spec7_num" value="0" />
            <select class="eg_select" name="attr_spec7_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec7} [[(((@{spec7_select}-@{dicemod})d6) + @{spec7_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec7"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec8" type="text" />
            <input type="number" name="attr_spec8_num" value="0" />
            <select class="eg_select" name="attr_spec8_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec8} [[(((@{spec8_select}-@{dicemod})d6) + @{spec8_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec8"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec9" type="text" />
            <input type="number" name="attr_spec9_num" value="0" />
            <select class="eg_select" name="attr_spec9_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec9} [[(((@{spec9_select}-@{dicemod})d6) + @{spec9_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec9"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec10" type="text" />
            <input type="number" name="attr_spec10_num" value="0" />
            <select class="eg_select" name="attr_spec10_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec10} [[(((@{spec10_select}-@{dicemod})d6) + @{spec10_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec10"></button>
        </div>        
        
        <div class="item">
            <input class="name" name="attr_spec11" type="text" />
            <input type="number" name="attr_spec11_num" value="0" />
            <select class="eg_select" name="attr_spec11_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec11} [[(((@{spec11_select}-@{dicemod})d6) + @{spec11_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec11"></button>
        </div>
        
        <div class="item">
            <input class="name" name="attr_spec12" type="text" />
            <input type="number" name="attr_spec12_num" value="0" />
            <select class="eg_select" name="attr_spec12_select">
                <option value="@{smi}">Smi</option>
                <option value="@{rea}">Rea</option>
                <option value="@{sty}">Sty</option>
                <option value="@{fys}">Fys</option>
                <option value="@{psy}">Psy</option>
                <option value="@{vis}">Vis</option>
                <option value="@{kar}">Kar</option>
                <option value="@{int}">Int</option>
            </select>
            <button type="roll" value="/e rolls @{spec12} [[(((@{spec12_select}-@{dicemod})d6) + @{spec12_num})-?{Svårighetsgrad|5}-@{skademod}]]" name="roll_spec12"></button>
        </div>        
    </div>
  </div>

  <div class='col'>
    <div class="kp">
        <h3>Hälsa</h3>
        <h4>Hälsopoäng <input type="number" name="attr_hpmax" value="0" /></h4>
        <h4>Kvarvarande <input type="number" name="attr_hp" value="0" /></h4>
    </div>
    
    <div>
        <h4>Förflyttning <input type="number" name="attr_move" value="0" /></h4>
        <h4>Stridsbonus <input type="number" name="attr_combat" value="0" /></h4>
    </div>
    
    <br>
    
    <div class="kroppsdelar">
        <h3>Kroppsdelar</h3>
        <h4>(oskadd/skadad/obrukbar)</h4>
        <h4>Huvud <input type="radio" value="0" checked="true" name="attr_head" /><input type="radio" value="1" name="attr_head" /><input type="radio" value="2" name="attr_head" /></h4>
        <h4>Höger arm <input type="radio" value="0" checked="true" name="attr_rarm" /><input type="radio" value="1" name="attr_rarm" /><input type="radio" value="2" name="attr_rarm" /></h4>
        <h4>Vänster arm <input type="radio" value="0" checked="true" name="attr_varm" /><input type="radio" value="1" name="attr_varm" /><input type="radio" value="2" name="attr_varm" /></h4>
        <h4>Bål <input type="radio" value="0" checked="true" name="attr_bal" /><input type="radio" value="1" name="attr_bal" /><input type="radio" value="2" name="attr_bal" /></h4>
        <h4>Höger ben <input type="radio" value="0" checked="true" name="attr_rben" /><input type="radio" value="1" name="attr_rben" /><input type="radio" value="2" name="attr_rben" /></h4>
        <h4>Vänster ben <input type="radio" value="0" checked="true" name="attr_vben" /><input type="radio" value="1" name="attr_vben" /><input type="radio" value="2" name="attr_vben" /></h4>
    </div>
    
    <br>
    
    <div class="utrustning">
        <h3>Utrustning</h3>
        <textarea name="attr_stuff" class="anteckningar" rows="1"></textarea>
    </div>    
  </div>
</div>

<script type="text/worker">
on("sheet:opened change:hp change:head change:rarm change:varm change:bal change:rben change:vben", function() {
    getAttrs(["hp", "hpmax", "head", "rarm", "varm", "bal", "rben", "vben"], function(values) {
        let hp = parseInt(values.hp,10)||0;
        let hpmax = parseInt(values.hpmax,10)||0;
        
        let head = parseInt(values.head,10)||0;
        let rarm = parseInt(values.rarm,10)||0;
        let varm = parseInt(values.varm,10)||0;
        let bal = parseInt(values.bal,10)||0;
        let rben = parseInt(values.rben,10)||0;
        let vben = parseInt(values.vben,10)||0;

        let newMod = 0;
        let diceMod = 0;

        if(hp < (hpmax /2) && hp >= (hpmax/4))
        {
            newMod += 1;
        }
        else if (hp < (hpmax / 4))
        {
            diceMod += 1;
        }

        if(head == 1)
        {
            newMod += 1;
        }

        if(rarm == 1)
        {
            newMod += 1;
        }   

        if(varm == 1)
        {
            newMod += 1;
        }     

        if(bal == 1)
        {
            newMod += 1;
        }

        if(rben == 1)
        {
            newMod += 1;
        }

        if(vben == 1)
        {
            newMod += 1;
        }
        
        setAttrs({
            skademod: newMod,
            dicemod: diceMod
        });
    });
});
</script>

